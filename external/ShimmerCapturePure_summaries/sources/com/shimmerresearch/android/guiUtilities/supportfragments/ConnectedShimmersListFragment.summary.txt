// Summary for: /mnt/c/dev/buccancs/external/ShimmerCapturePure/sources/com/shimmerresearch/android/guiUtilities/supportfragments/ConnectedShimmersListFragment.java
// Size: 6249 bytes
// Modified: 2025-10-21 16:32:13.190799400 +0100

package com.shimmerresearch.android.guiUtilities.supportfragments;

import android.R;
import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.CheckedTextView;
import android.widget.ListView;
import androidx.fragment.app.ListFragment;
import com.shimmerresearch.driver.ShimmerDevice;
import java.util.List;
import org.apache.commons.lang3.StringUtils;

/* loaded from: classes2.dex */
public class ConnectedShimmersListFragment extends ListFragment {
    static final String LOG_TAG = "SHIMMER";
    Context context;
    OnShimmerDeviceSelectedListener mCallBack;
    String selectedDeviceAddress;
    List<ShimmerDevice> shimmerDeviceList;
    ListView savedListView = null;
    ArrayAdapter<String> savedListAdapter = null;
    int selectedDevicePos = -1;

    public interface OnShimmerDeviceSelectedListener {
        void onShimmerDeviceSelected(String str, String str2, Boolean bool);
    }

    public void removeSelectedDevice() {
        this.selectedDeviceAddress = null;
        this.selectedDevicePos = -1;
    }

    /* JADX WARN: Multi-variable type inference failed */
    @Override // androidx.fragment.app.Fragment
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        try {
            this.mCallBack = (OnShimmerDeviceSelectedListener) activity;
        } catch (ClassCastException unused) {
            throw new ClassCastException(activity.toString() + " must implement OnShimmerDeviceSelectedListener");
        }
    }

    public static ConnectedShimmersListFragment newInstance() {
        ConnectedShimmersListFragment connectedShimmersListFragment = new ConnectedShimmersListFragment();
        connectedShimmersListFragment.setArguments(new Bundle());
        return connectedShimmersListFragment;
    }

    public void buildShimmersConnectedListView(List<ShimmerDevice> list, Context context) {
        if (isVisible()) {
            this.shimmerDeviceList = list;
            this.context = context;
            if (list == null) {
                setListAdapter(new ArrayAdapter(context, R.layout.simple_list_item_1, new String[]{"No devices connected"}));
                return;
            }
            int size = list.size();
            final String[] strArr = new String[size];
            final String[] strArr2 = new String[list.size()];
            String[] strArr3 = new String[list.size()];
            for (int i = 0; i < size; i++) {
                strArr[i] = list.get(i).getShimmerUserAssignedName();
                strArr2[i] = list.get(i).getMacId();
                strArr3[i] = strArr[i] + StringUtils.LF + strArr2[i];
            }
            ArrayAdapter<String> arrayAdapter = new ArrayAdapter<>(context, com.shimmerresearch.androidinstrumentdriver.R.layout.simple_list_item_multiple_choice_force_black_text, strArr3);
            setListAdapter(arrayAdapter);
            ListView listView = getListView();
            listView.setChoiceMode(1);
            listView.setOnItemClickListener(new AdapterView.OnItemClickListener() { // from class: com.shimmerresearch.android.guiUtilities.supportfragments.ConnectedShimmersListFragment.1
                @Override // android.widget.AdapterView.OnItemClickListener
                public void onItemClick(AdapterView<?> adapterView, View view, int i2, long j) {
                    if (ConnectedShimmersListFragment.this.selectedDeviceAddress != null && ConnectedShimmersListFragment.this.selectedDeviceAddress == strArr2[i2]) {
                        ConnectedShimmersListFragment.this.selectedDeviceAddress = null;
                        ConnectedShimmersListFragment.this.selectedDevicePos = -1;
                    } else {
                        ConnectedShimmersListFragment.this.selectedDeviceAddress = strArr2[i2];
                        ConnectedShimmersListFragment.this.selectedDevicePos = i2;
                    }
                    try {
                        ConnectedShimmersListFragment.this.mCallBack.onShimmerDeviceSelected(strArr2[i2], strArr[i2], Boolean.valueOf(ConnectedShimmersListFragment.this.selectedDevicePos != -1));
                    } catch (ClassCastException unused) {
                    }
                }
            });
            this.savedListView = listView;
            this.savedListAdapter = arrayAdapter;
            for (int i2 = 0; i2 < listView.getAdapter().getCount(); i2++) {
                CheckedTextView checkedTextView = (CheckedTextView) getViewByPosition(i2, listView).findViewById(R.id.text1);
                if (checkedTextView != null) {
                    String string = checkedTextView.getText().toString();
                    String str = this.selectedDeviceAddress;
                    if (str == null || !string.contains(str)) {
                        listView.setItemChecked(i2, false);
                    } else {
                        listView.setItemChecked(i2, true);
                    }
                }
            }
        }
    }

    @Override // androidx.fragment.app.Fragment
    public void onResume() {
        if (this.savedListView != null && this.savedListAdapter != null) {
            buildShimmersConnectedListView(this.shimmerDeviceList, this.context);
        } else {
            buildShimmersConnectedListView(null, getActivity().getApplicationContext());
        }
        super.onResume();
    }

    public View getViewByPosition(int i, ListView listView) {
        int firstVisiblePosition = listView.getFirstVisiblePosition();
        int childCount = (listView.getChildCount() + firstVisiblePosition) - 1;
        if (i < firstVisiblePosition || i > childCount) {
            return listView.getAdapter().getView(i, null, listView);
        }
        return listView.getChildAt(i - firstVisiblePosition);
    }

    public int getNumShimmersConnected() {
        List<ShimmerDevice> list = this.shimmerDeviceList;
        if (list != null) {
            return list.size();
        }
        return 0;
    }
}

// Summary for: /mnt/c/dev/buccancs/external/ShimmerCapturePure/sources/io/grpc/alts/internal/BufUnwrapper.java
// Size: 1557 bytes
// Modified: 2025-10-21 16:32:07.659460300 +0100

package io.grpc.alts.internal;

import io.grpc.netty.shaded.io.netty.buffer.ByteBuf;
import io.grpc.netty.shaded.io.netty.buffer.CompositeByteBuf;
import java.nio.ByteBuffer;

/* loaded from: classes2.dex */
final class BufUnwrapper implements AutoCloseable {
    private final ByteBuffer[] singleReadBuffer = new ByteBuffer[1];
    private final ByteBuffer[] singleWriteBuffer = new ByteBuffer[1];

    BufUnwrapper() {
    }

    ByteBuffer[] writableNioBuffers(ByteBuf byteBuf) {
        int i = byteBuf.readerIndex();
        int iWriterIndex = byteBuf.writerIndex();
        byteBuf.readerIndex(iWriterIndex);
        byteBuf.writerIndex(byteBuf.capacity());
        try {
            return nioBuffers(byteBuf, this.singleWriteBuffer);
        } finally {
            byteBuf.readerIndex(i);
            byteBuf.writerIndex(iWriterIndex);
        }
    }

    ByteBuffer[] readableNioBuffers(ByteBuf byteBuf) {
        return nioBuffers(byteBuf, this.singleReadBuffer);
    }

    @Override // java.lang.AutoCloseable
    public void close() {
        this.singleReadBuffer[0] = null;
        this.singleWriteBuffer[0] = null;
    }

    private static ByteBuffer[] nioBuffers(ByteBuf byteBuf, ByteBuffer[] byteBufferArr) {
        if (!(byteBuf instanceof CompositeByteBuf) && byteBuf.nioBufferCount() == 1) {
            byteBufferArr[0] = byteBuf.internalNioBuffer(byteBuf.readerIndex(), byteBuf.readableBytes());
            return byteBufferArr;
        }
        return byteBuf.nioBuffers();
    }
}
